#!bin/termex

dbg installer "Installation in progress..."

if [ -d ~/.termex ]
then
    read -p "Termex is already installed. Update? [Y|n] " -n 1 update
    echo ""
    
    [ "$update" == "n" ] && exit
    
    dbg installer "Updating Termex..."
    bin/termex-update
    exit
fi

dbg installer "Checking out latest version..."
git checkout tags/$TERMEX || die 1 "Git checkout failed."

dbg installer "Copying files..."
mkdir ~/.termex
cp -r . ~/.termex || die 2 "Copying failed."

dbg installer "Finishing up installation..."
cat ~/.bashrc > "$(mktemp -p ~ .bashrc.XXXXXXXX)"
echo -e "\nexport PATH=\"\$PATH:$(readlink -f ~/.termex/bin)\"" >> ~/.bashrc

dbg installer "Installation finished."
